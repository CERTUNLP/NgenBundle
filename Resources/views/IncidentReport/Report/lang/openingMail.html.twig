{#
 This file is part of the Ngen - CSIRT Incident Report System.

 (c) CERT UNLP <support@cert.unlp.edu.ar>

 This source file is subject to the GPL v3.0 license that is bundled
 with this source code in the file LICENSE.
#}
{% extends  'CertUnlpNgenBundle:IncidentReport:Report/lang/mail.html.twig' %}
{% block greeting %}
    {{ 'greeting'|trans }} {{ incident.network.networkAdmin }},
{% endblock %}
{% block report_content %}
    {% if(report.problem) %}
        <tr>
            <td>
                {% block report_message %}
                    {{ include(template_from_string(report.problem))|striptags('<div>,<a>,<pre>,<code>')|raw }}
                {% endblock %}
            </td>
        </tr>
    {% endif %}
    {% set titulos=0 %}
    {% block incidents_detected %}
        {% for detected in incident.incidentsDetected %}
            {% if(detected.notes) %}
                {% if titulos == 0 %}
                    {% set titulos=1 %}
                    <tr>
                    <td>
                    <p>
                    {% block incident_notes_title %}
                        <h5>{{ 'incident_notes_title'|trans }}</h5>
                    {% endblock %}
                    </p>
                    <ul>
                {% endif %}

                {{ detected.notes| striptags('<div>,<a>,<pre>,<code>,<li>,<ul>,<br>')|raw|nl2br }}

            {% endif %}
        {% endfor %}
        {% if titulos == 1 %}
            </ul>
            </td>
            </tr>
        {% endif %}
    {% endblock %}

    {% block derivated_problem %}
        {% if(report.derivatedProblem) %}
            <tr>
                <td>
                    <p>
                        {% block derivated_problem_title %}
                    <h5>{{ 'derivated_problem_title'|trans }}</h5>
                    {% endblock %}
                    </p>
                    {{ report.derivatedProblem|striptags('<div>,<a>,<pre>,<code>')|raw }}
                </td>
            </tr>
        {% endif %}
    {% endblock %}
    {% block verification %}
        {% if(report.verification) %}
            <tr>
                <td>
                    <p>
                        {% block verification_title %}
                    <h5>{{ 'verification_title'|trans }}</h5>
                    {% endblock %}
                    </p>
                    {{ report.verification|striptags('<div>,<a>,<pre>,<code>')|raw }}
                </td>
            </tr>
        {% endif %}
    {% endblock %}
    {% block recomendations %}

        {% if(report.recomendations) %}
            <tr>
                <td>
                    <p>
                        {% block recomendations_title %}
                    <h5>{{ 'recomendations_title'|trans }}</h5>
                    {% endblock %}
                    </p>
                    {{ report.recomendations|striptags('<div>,<a>,<pre>,<code>')|raw }}
                </td>
            </tr>
        {% endif %}
    {% endblock %}
    {% block more_information %}
        {% if(report.moreInformation) %}
            <tr>
                <td>
                    <p>
                        {% block more_information_title %}
                    <h5>{{ 'more_information_title'|trans }}</h5>
                    {% endblock %}
                    </p>
                    {{ report.moreInformation|striptags('<div>,<a>,<pre>,<code>')|raw }}
                </td>
            </tr>
        {% endif %}
    {% endblock %}
{% endblock report_content %}
