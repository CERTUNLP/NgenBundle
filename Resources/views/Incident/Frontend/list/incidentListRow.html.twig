{# 
 This file is part of the Ngen - CSIRT Incident Report System.
 
 (c) CERT UNLP <support@cert.unlp.edu.ar>
 
 This source file is subject to the GPL v3.0 license that is bundled
 with this source code in the file LICENSE.
#}

<tr data-id="{{ incident.id }}" role="row">
    <td id="state_label_holder">
        <div class="label-holder">
            {% include "CertUnlpNgenBundle:Incident:Frontend/list/stateLabel.html.twig" with {'incident': incident} %}
        </div>
    </td>
    <td>
        {{ incident.address }}
    </td>

    <td>
        {{ incident.assigned }}
    </td>
    <td>
        {{ incident.type }}
    </td>
    <td>
        {{ incident.feed }}
    </td>
    <td>
        {{ incident.date|date('Y-m-d H:i') }}
    </td>
    <td>
        {{ incident.priority }}
    </td>
    <td>
        {% include "CertUnlpNgenBundle:Incident:Frontend/ltdLabel.html.twig" with {'incident': incident,'incidentsDetected':incident.incidentsDetected} %}
    </td>
    <td>

        <div class="btn-group inline pull-left dropdown action-dropdown">
            <a class="btn btn-sm btn-primary" role="button"
               href="{{ path('cert_unlp_ngen_internal_incident_frontend_detail_incident',{'slug':incident.id}) }}">
                {{ 'Detail'|trans }}
            </a>
            <a class="btn btn-sm btn-primary" role="button"
               href="{{ path('cert_unlp_ngen_internal_incident_frontend_edit_incident_id',{'id': incident.id}) }}">
                {{ 'Edit'|trans }}
            </a>
            <button class="btn btn-sm btn-primary ladda-button dropdown-toggle" data-style="slide-down" type="button"
                    id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                {{ 'Actions'| trans }}
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

                {% if incident.isNew == true %}
                    <li class="list-group-item" role="presentation">
                        <a class="state-label"
                           data-state-slug="open" data-state-name="Open" tabindex="-1"
                           href="#">{{ icon('  alert-info') }} <span class="action-text"> {{ 'Open'|trans }}</span></a>
                    </li>
                    <li class="list-group-item" role="presentation">
                        <a class="state-label" data-state-slug="removed" data-state-name="Removed" role="menuitem"
                           tabindex="-1" href="#">{{ icon('remove alert-danger') }} <span
                                    class="action-text"> {{ 'Discard'| trans }}</span></a>
                    </li>

                {% endif %}

                {% if incident.isNew == false %}
                    <li class="list-group-item" role="presentation">
                        <a class="state-label" data-state-slug="closed" data-state-name="Closed" role="menuitem"
                           tabindex="-1" href="#">{{ icon('lock alert-success') }} <span
                                    class="action-text">{{ 'Close'|trans }}</span></a>
                    </li>
                    <li  class="list-group-item" role="presentation">
                        <a class="state-label" data-state-slug="closed_by_inactivity"
                           data-state-name="Closed by inactivity"
                           role="menuitem" tabindex="-1" href="#">{{ icon('hourglass alert-danger') }} <span
                                    class="action-text">{{ 'Close by inactivity'|trans }}</span></a>
                    </li>
                {% endif %}

                <li  class="list-group-item" role="presentation">
                    <a role="menuitem" tabindex="-1"
                       href="{{ path('cert_unlp_ngen_internal_incident_frontend_edit_incident_id',{'id': incident.id}) }}">{{ icon('edit alert-info') }}
                        <span class="action-text">Edit{{ incident.isNew }}</span></a>
                </li>

            </ul>
        </div>
    </td>
</tr>