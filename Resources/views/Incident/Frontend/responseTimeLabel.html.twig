{# 
 This file is part of the Ngen - CSIRT Incident Report System.
 
 (c) CERT UNLP <support@cert.unlp.edu.ar>
 
 This source file is subject to the GPL v3.0 license that is bundled
 with this source code in the file LICENSE.
#}
{% set incident.responseDelayedMinutes= incident.priority.responsetime-incident.responseMinutes %}

{% if (incident.responseDelayedMinutes > 0) %}
    {% if  incident.isNew %}
        {{ label_warning('Waiting for response '|trans ~ incident.responseDelayedMinutes ~ ' minutes left'|trans) }}
    {% else %}
        {{ label_success('Response on time '|trans ~ incident.responseDelayedMinutes ~ ' minutes left'|trans) }}
    {% endif %}
{% else %}
    {% if incident.isNew %}
        {{ label_danger('Waiting for response '|trans ~ (incident.responseDelayedMinutes * -1) ~ ' minutes delayed'|trans) }}
    {% else %}
        {{ label_danger('Response delayed for '|trans ~ (incident.responseDelayedMinutes * -1) ~ ' minutes '|trans) }}
    {% endif %}

{% endif %}

